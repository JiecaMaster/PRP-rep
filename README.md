# PRP-rep
 Codes of a PRP for detecting attack on network flow with LLM

* csv_cut.py 用于选取相关label的流量数据
* sort_by_size.py 将所有数据条目根据Average Packet Size的大小进行排序
* get_sample.py 对已经排序的条目进行相对均匀的随机抽样，得到样例条目
* remove_columns.py 删去不想展示的条目
* merge_shuffle.py 可以合并字段相同的2份csv文件，并选择是否打乱所有行

* 在构建输入数据时的注意事项：
  1. 不采用表格的方式构建输入数据，而是在每个数据之前都加上相应的字段名（待测试更高级模型是否使用表格输入时可以摆脱幻觉）
  2. 在构建输入数据时务必给每一行前面加上记录标号，可以减轻模型幻觉
  3. 在要求模型进行标签输出时，给出特定的格式，如\$ Label \$,否则模型可能在部分时候拒绝预测

* Prompt构建方式：
  1. 设定角色：你是xxx攻击方面的专家，你将帮助人类进行xxx攻击的判定
  2. 描述输入：接下来，我将给你提供xxx信息/样例
  3. 提供样本：已经构建过的包含标签的输入样本
  4. 描述任务：分析输入样本中的数据特点，对一批xxx数据进行分类，以xxx的格式输出标签，例如xxx条目信息为：xxx，你如果认为他是xxx攻击，则输出xxx
  5. 提供实验数据：删去了标签的实验数据

* Prompt of hulk(test1):
  1. 你是关于拒绝服务攻击（DoS）方面的专家，你将帮助人类进行DoS攻击的判定
  2. 接下来，我将给你提供20条流量的数据信息，包括10条标记为BENIGN的良性流量，与10条已被标记出的DoS Hulk攻击的流量，
  3. 样本与标签
  4. 请你根据提供的样本，仔细分析恶意流量的行为模式与数据特点，并对以下数据进行分类，并以这样的格式输出你分类的标签：record1： \$ label1 \$; record2 : \$ label2 \$; ...
  5. test数据